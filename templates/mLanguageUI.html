

<!DOCTYPE html>
<html>
<link rel="stylesheet" href="{{ url_for('static', filename='css/jquery-ui.css') }}">
</link>
<link rel="stylesheet" href="{{ url_for('static', filename='css/SwagStyle.css') }}">
</link>

<script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
<script src='https://cdn.plot.ly/plotly-latest.min.js'></script>
<script src="{{ url_for('static', filename='js/variableListener.js') }}"></script>
<script src="{{ url_for('static', filename='js/connect_WebUI.js') }}"></script>
<script src="{{ url_for('static', filename='js/connect_socketIO_main.js') }}"></script>

{% include 'templates.html' %}

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<style>
    .row {
        display: flex;
    }

    .column {
        flex: 12%;
        padding: 1px;
    }

    html,
    body {
        background-color: '#ffffff';
        overflow: hidden;
    }
</style>

<body class="unselectable" style="width:1750px"> 

<div id = "languageUI"> 
    <mc-module name="ASSISTANT ENGINE">
        <button id="clearbutton" class="swagButton" onclick="clearChat()" style="float:right;">CLEAR</button>
        <mc-scrollbox id='scrollbox'></mc-scrollbox>

        <mc-TextInput id="textInput" type="textinput" fn="textinput" ></mc-TextInput>
        <button id="searchbutton" class="swagButton" onclick="processQuery()">GO</button>
    </mc-module>
</div>
</body>

</html>

<script>
function clearChat(){
    document.getElementById("scrollbox").shadowRoot.getElementById("box").innerHTML = '';
}

function processQuery(){
    var text = document.getElementById("textInput").shadowRoot.getElementById("text").value;
    var chatwin = document.getElementById("scrollbox").shadowRoot.getElementById("box");

    fetch("/languageUI_process", {
            method: "POST",
            body: JSON.stringify({ text: text }),
            headers: {
                "Content-type": "application/json; charset=UTF-8"
            }
            })
            .then((response) => response.json())
            .then((json) => {
                chatwin.innerHTML += '<br>HUMAN: ' + text + "<br>"; 
                chatwin.innerHTML += "<br>DATA: " + json.result + '<br>';
                chatwin.scrollTop = chatwin.scrollHeight;  

                // Clear the input field
                document.getElementById("textInput").shadowRoot.getElementById("text").value = '';
            });
}

// Add event listener for Enter key
document.getElementById("textInput").shadowRoot.getElementById("text").addEventListener("keydown", function(event) {
    if (event.key === "Enter") {
        processQuery();
    }
});

// Change the placeholder text for the specific element
document.addEventListener("DOMContentLoaded", function() {
            var specificElement = document.getElementById("textInput");
            var shadowRoot = specificElement.shadowRoot;
            var textArea = shadowRoot.getElementById("text");
            textArea.placeholder = "Type something. e.g. 'Open project teapot.' ...";
});


</script>
